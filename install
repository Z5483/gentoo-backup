#!/usr/bin/env bash

if [ "$EUID" -ne 0 ]; then
	echo "Please run as root."
	exit 0
fi

REPO=$(cd "$(dirname "${BASH_SOURCE[0]}")" > /dev/null 2>&1 && pwd)

mkdir -p /etc/X11
cp -r $REPO/etc/X11/* /etc/X11/

mkdir -p /etc/fonts
cp $REPO/etc/fonts/fonts.conf /etc/fonts/

mkdir -p /etc/libvirt
cp $REPO/etc/libvirt/libvirtd.conf /etc/libvirt/

mkdir -p /usr/share/cursors/xorg-x11
cp -r $REPO/usr/share/cursors/xorg-x11/* /usr/share/cursors/xorg-x11/

mkdir -p /var/tmp/ccache
cp $REPO/var/tmp/ccache/ccache.conf /var/tmp/ccache

cp -r $REPO/boot/loader/* /boot/loader/

cp $REPO/etc/fstab /etc/fstab

cp $REPO/etc/genkernel.conf /etc/genkernel.conf

cp $REPO/etc/sysctl.conf /etc/sysctl.conf

cp $REPO/usr/share/consolefonts/* /usr/share/consolefonts/

cp -r $REPO/etc/portage/* /etc/portage/

mkdir -p /etc/systemd
cp -r $REPO/etc/systemd/* /etc/systemd/

mkdir -p /etc/layman
cp -r $REPOS/etc/layman/* /etc/layman/

mkdir -p /etc/udev
cp -r $REPO/etc/udev/* /etc/udev/

mkdir -p /usr/src/initramfs/{bin,dev,etc,lib,lib64,mnt/root,proc,root,sbin,sys}
cp --archive /dev/{null,console,tty,sda1} /usr/src/initramfs/dev/
cp -r $REPO/usr/src/initramfs/* /usr/src/initramfs
echo 'entering: /usr/src/initramfs'
find . -print0 | cpio --null --create --verbose --format=newc | gzip --best > ./custom-initramfs.cpio.gz

echo 'success!'
